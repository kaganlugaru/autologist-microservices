-- üìã –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
-- –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è phone

-- 1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–∂–µ –µ—Å—Ç—å
SELECT id, name FROM categories ORDER BY name;

-- 2. –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
-- (–ó–∞–º–µ–Ω–∏—Ç–µ category_id –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID –∏–∑ –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã categories)

INSERT INTO recipient_categories (name, phone, category_id, created_at) VALUES 
-- –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–ª—è –≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–æ–∫
('–î–∏—Å–ø–µ—Ç—á–µ—Ä –ê–ª–º–∞—Ç—ã', '+77771234567', 1, NOW()),
('–ú–µ–Ω–µ–¥–∂–µ—Ä –ê—Å—Ç–∞–Ω–∞', '+77772345678', 1, NOW()),
('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –®—ã–º–∫–µ–Ω—Ç', '+77773456789', 1, NOW()),

-- –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–µ–π  
('–°–∫–ª–∞–¥ –∑–∞–ø—á–∞—Å—Ç–µ–π', '+77774567890', 2, NOW()),
('–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º', '+77775678901', 2, NOW()),

-- –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
('–ú–∞—Å—Ç–µ—Ä-–ø—Ä–∏–µ–º—â–∏–∫', '+77776789012', 3, NOW()),
('–ì–ª–∞–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∫', '+77777890123', 3, NOW())

ON CONFLICT DO NOTHING;

-- 3. –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π, –¥–æ–±–∞–≤–ª—è—è –∏–º –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
-- (–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤)

UPDATE recipient_categories 
SET phone = '+77771111111' 
WHERE name = '–ê–¥–º–∏–Ω' AND phone IS NULL;

UPDATE recipient_categories 
SET phone = '+77772222222' 
WHERE name = '–°—É–ø–µ—Ä–≤–∞–π–∑–µ—Ä' AND phone IS NULL;

-- 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
SELECT 
    rc.id,
    rc.name as recipient_name,
    rc.phone,
    rc.username,
    c.name as category_name
FROM recipient_categories rc
LEFT JOIN categories c ON rc.category_id = c.id
ORDER BY c.name, rc.name;