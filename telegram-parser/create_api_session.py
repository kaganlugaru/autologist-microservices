#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ—Å—Å–∏–∏ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ —á–∞—Ç–æ–≤
–ù–µ –º–µ—à–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—é—â–µ–º—É –ø–∞—Ä—Å–µ—Ä—É
"""

import asyncio
import os
import sys
from pathlib import Path
from telethon import TelegramClient

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ —á—Ç–æ –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ)
API_ID = 24596648
API_HASH = 'a7ad822cca0d197a02279dea6a2e84fc'

# –ò–º—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –¥–ª—è API
SESSION_NAME = 'api_chats'

async def create_api_session():
    """–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤"""
    
    print("üîß –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ—Å—Å–∏–∏ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ —á–∞—Ç–æ–≤")
    print("=" * 50)
    print(f"üì± API ID: {API_ID}")
    print(f"üîë Session: {SESSION_NAME}")
    print()
    
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç —Å –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º —Å–µ—Å—Å–∏–∏
    client = TelegramClient(SESSION_NAME, API_ID, API_HASH)
    
    try:
        print("üîå –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Telegram...")
        await client.start()
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        me = await client.get_me()
        print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫–∞–∫: {me.first_name} (@{me.username})")
        print()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–µ—Å—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
        dialogs = await client.get_dialogs(limit=5)
        print(f"üìã –ù–∞–π–¥–µ–Ω–æ {len(dialogs)} —á–∞—Ç–æ–≤ (—Ç–µ—Å—Ç)")
        
        print()
        print("üéâ –°–µ—Å—Å–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!")
        print(f"üìÑ –§–∞–π–ª —Å–µ—Å—Å–∏–∏: {SESSION_NAME}.session")
        print()
        print("üìÅ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É telegram-parser –ø—Ä–æ–µ–∫—Ç–∞")
        print("üí° –≠—Ç–∞ —Å–µ—Å—Å–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏: {e}")
        print()
        print("üí° –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:")
        print("  - –£ –≤–∞—Å –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç")  
        print("  - API_ID –∏ API_HASH –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ")
        print("  - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è SMS")
        
    finally:
        await client.disconnect()

if __name__ == '__main__':
    print("üöÄ –ó–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è API —Å–µ—Å—Å–∏–∏...")
    print()
    print("üì± –í–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è:")
    print("  1. –í–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞")
    print("  2. –í–≤–µ—Å—Ç–∏ –∫–æ–¥ –∏–∑ SMS")
    print("  3. –í–æ–∑–º–æ–∂–Ω–æ –ø–∞—Ä–æ–ª—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏")
    print()
    
    input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
    print()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    asyncio.run(create_api_session())